var upp=angular.module("upp",["ngRoute","ngResource","ngSanitize","tmh.dynamicLocale"]);!function(a){"use strict";a.config(["$routeProvider",function(a){function b(a){var b=this;b.module=a;var c=function(a){return a.isAnActiveModule(b.module)};c.$inject=["config"],this.resolver=c}var c=function(a){return new b(a)};a.ResolverFactory={moduleIsActivated:c},a.when("/token/:token",{templateUrl:"templates/plugins/login/token.html"}).when("/password/change/:token",{template:'<div ng-controller="upp.plugins.login.ChangePasswordCtrl"></div>'}).when("/",{templateUrl:"templates/app/home.html"}).otherwise({redirectTo:"/"})}]),a.factory("exception",function(){function a(a,b){this.type=a,this.msg=b}var b=function(b,c){return new a(b,c)},c=function(a){return b("fatal",a)},d=function(a){return b("minor",a)};return{fatal:c,minor:d}}),a.config(["$httpProvider",function(a){a.defaults.headers.common["X-Requested-With"]=null,a.defaults.headers.common.ChildUpp=$UPP.PROPS.IDCHILDUPP,a.defaults.withCredentials=!1,a.defaults.headers.common["Content-Type"]="application/json; charset=utf-8",a.defaults.cache=!1;var b=["$q","utils",function(a,b){function c(a){return a}function d(c){return c&&c.data&&(c.data.translatedErrorMessage=b.i18nHttpErrorCode(c.data.errorMessageCode)),a.reject(c)}return function(a){return a.then(c,d)}}];a.responseInterceptors.push(b)}]),a.config(["$locationProvider",function(a){a.hashPrefix("!")}]),a.config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|skype):/)}]),a.config(["tmhDynamicLocaleProvider",function(a){a.localeLocationPattern("./lib/angular/locales/angular-locale_{{locale}}.min.js")}]),a.run(["$rootScope","storage","routeInterceptorService",function(a,b,c){a.$on("$locationChangeStart",function(a,d,e){b.set("currentRoute",d),b.set("prevRoute",e),c.intercept(d,e)})}])}(upp),function(a){"use strict";a.controller("upp.HomeContentCtrl",["$scope",function(){}]).controller("upp.HomeCtrl",["$scope","$rootScope","$window","appi","eShopService","config","$sce",function(a,b,c,d,e,f,g){d.ui.changeActualOption({text:b.childuppName,navbarKey:"home"}),a.infiniteScroll=!0,a.listProducts=e.listEshopProducts,f.getLogoPath().then(function(b){a.logo=b}),f.getContent().then(function(b){b?(a.content=g.trustAsHtml(b),a.showProducts=!1):a.showProducts=!0})}])}(upp),function(a){"use strict";a.controller("upp.MainCtrl",["$scope","$rootScope","$q","$location","$window","translator","analytics","config","push","cartService",function(a,b,c,d,e,f,g,h){var i=!1,j=function(a){a&&f.setLang(a)},k=function(){b.showSpin&&b.showSpin()},l=function(){b.closeSpin&&b.closeSpin()},m=function(){l(),o({desc:"NETWORK_ERROR"})},n=function(b,c){i||(a.error=b,a.error.full=c)},o=function(a){n(a,!1)},p=function(a){n(a,!0)};a.$on("$routeChangeStart",function(){i||(a.error=void 0)}),a.$on("$routeChangeSuccess",function(a,c){var d=c&&c.$$route&&c.$$route.showAd;d?b.enableAds():b.disableAds()}),a.$on("$routeChangeError",function(a,b,c,e){"inactive"===e&&d.path("/"),l()}),setTimeout(function(){g.registerNewConnection()},2e3),h.isChilduppInactive().then(function(a){p({desc:a}),i=!0},function(a){a&&a.warning&&console.warn(a.warning)}),h.getChilduppName().then(function(a){var c=a||e.nameapp;b.childuppName=c,e.document.title=c},function(){var a=e.nameapp;b.childuppName=a,e.document.title=a}),h.shouldShowUppSignature().then(function(a){b.showUppSignature=void 0===a?!0:a},function(){b.showUppSignature=!0}),h.shouldShowAccount().then(function(a){b.account=void 0===a?!1:a},function(){b.account=!1}),a.changeLanguage=j,b.showPageLoadingMsg=k,b.hidePageLoadingMsg=l,b.showInlineError=o,b.showFullError=p,b.showNetworkError=m}])}(upp),function(a){"use strict";a.controller("upp.TokenCtrl",["$rootScope","$routeParams","location","storage","authManager",function(a,b,c,d,e){var f=b.token;if(f){f=atob(f),d.set("upplicationToken",f);var g={type:"Token",token:f};e.login(g).then(function(){"true"===d.get("redirectToCart")?(d.remove("redirectToCart"),c.path("/cart/order")):"true"===d.get("redirectToBookings")?(d.remove("redirectToBookings"),c.path("/bookings")):c.path("/"),a.$broadcast("registerSuccess:open")})}else c.path("/")}])}(upp),function(a){"use strict";a.directive("currentPageTpl",["config","translator",function(a,b){return{restrict:"E",replace:!0,link:function(c,d,e){var f=function(a){d.replaceWith('<h1 class="page-title">'+a+"</h1>")};e.pageKey?a.getModuleDisplayText(e.pageKey).then(function(a){f(a)}):f(b.i18n(e.pageTitle))}}}])}(upp);var $UPP=$UPP||{};$UPP.PROPS=$UPP.PROPS||{},function(a,b,c){"use strict";a.directive("modalMessageTpl",["$rootScope","translator","$sce",function(a,b,c){var d,e,f,g=function(a){e.title=a.title,e.message=c.trustAsHtml(h(a.message)),e.closeButton=a.closeButton,a.confirmButton&&(e.confirmButton=a.confirmButton,e.confirm=a.confirmButton.callback),a.closeButton&&(e.closeButton=a.closeButton,e.close=a.closeButton.callback),e.$$phase||e.$apply()},h=function(a){return b&&("string"==typeof a?a=b.i18n(a):a.hasOwnProperty("key")&&(a.hasOwnProperty("pluralize")?a=b.pluralizeI18n(a.key,a.pluralize):a.hasOwnProperty("params")&&(a=b.i18n(a.key,a.params)))),a},i=function(){(d||(d=f)).modal("show")},j=function(){$(".cancel",f).trigger("click")},k=function(){$(".confirm",f).trigger("click")},l=function(a){d.unbind("keypress").bind("keypress",function(b){13===b.which&&(b.preventDefault(),a?k():j())})};return{restrict:"E",templateUrl:"templates/app/modal_message.html",replace:!0,controller:["$scope","$element",function(b,c){e=b,f=c,a.showModalMessage=function(a){g(a),i(),l(a.confirmButton)}}]}}]).directive("modalSpinTpl",["$rootScope","config",function(a,c){var d,e,f,g=1e4,h=function(){f&&clearTimeout(f)},i=function(){h(),d.css("display","block"),e.css("display","block"),e.spin(),f=setTimeout(function(){j()},g)},j=function(){h();var a=$("#content-wrapper"),f=$("#main-container"),g=$(b.body),i=$(b.getElementsByTagName("html")[0]),j=$("#app-background");c.getBackground().then(function(b){var c;if(b){g.addClass("with-background");var d={background:"#FFF url("+b+") center center fixed no-repeat","background-size":"cover"};i.css(d),j.css(d),c={background:"transparent"}}else c={background:"#FFFFFF"};a.css(c),f.css(c),g.css(c)}),d.css("display","none"),e.css("display","none")};return{restrict:"E",controller:function(){a.showSpin=function(){i()},a.closeSpin=function(){j()}},link:function(a,b){d=$("<div/>",{id:"spin-overlay"}),e=$("<div/>",{id:"spin-modal"}).appendTo(d),b.replaceWith(d)}}}]).directive("errorMessageTpl",function(){return{restrict:"E",replace:!0,priority:0,template:'<div id="global-error" class="alert alert-error inline-error without_section-error">   <button type="button" class="close" data-dismiss="alert">&times;</button>   <p class="inline-error-message"><strong>{{\'ERROR\' | i18n}}.</strong> {{error.desc | i18n}}</p></div>',link:function(a,b){var c,d=$("#content"),e=function(){c=$("#navbar-main-options, #navbar-main-sections")};b.hide(),a.$watch("error",function(a){e(),a?(b.show(),d.hide(),a.full&&(c.length?c.hide():setTimeout(function(){e(),c.hide()},10))):(c.show(),d.show(),b.hide())})}}}).directive("currencyTpl",function(){return{restrict:"E",scope:{currencySymbol:"="},replace:!0,link:function(a,b){a.$watch("currencySymbol",function(a){a&&b.replaceWith(a)})}}}).directive("placeholderTooltip",function(){return{restrict:"C",replace:!1,link:function(a,b){b.tooltip({trigger:"focus",delay:{show:500,hide:0},title:function(){return b.attr("placeholder")}})}}}).directive("sameAs",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return b===a[c.sameAs]?d.$setValidity("sameAs",!0):d.$setValidity("sameAs",!1),b})}}}).directive("max",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){return parseInt(a)<=parseInt(c.max)?d.$setValidity("max",!0):d.$setValidity("max",!1),a})}}}).directive("navTabsResponsive",["$filter","$location",function(a,b){var c=function(a){var b=new RegExp("{{[\\s]*'([A-Z.]+)'[\\s]*|[\\s]*i18n[\\s]*}}");return function(c){var d;return b.test(c)&&(d=c.match(b),d&&d[1]&&(c=a("i18n")(d[1]))),c}}(a);return{restrict:"C",link:function(a,d){var e=$("<div/>").addClass("nav-tabs-responsive-select-wrapper"),f=$("<select/>").addClass("nav-tabs-responsive");f.appendTo(e),d.after(e),f.change(function(){var a=$(this).find("option:selected").val();$('a[href="'+a+'"]',d).trigger("click")});var g=angular.element(d).scope(),h=function(){var a,e,g;$("a",d).each(function(){a=$(this),e={value:a.attr("href"),text:c(a.find("span.enabled").text())},a.parent("li").hasClass("active")&&(e.selected="selected"),a.parent("li").hasClass("enabled")&&$("<option />",e).appendTo(f)});var h=f.find("option:selected").val();void 0!==h&&(g=h.split("!")[1]),g!==b.path()&&void 0!==g&&b.path(g)};"object"==typeof g.info&&h(),a.$on("event:onAppInfoLoaded",h)}}}]).directive("iosStatusBar",["$timeout",function(a){return{restrict:"E",template:'<div class="ios-status-bar"></div>',link:function(){a(function(){if(c.PROPS.IOS)for(var a=["navbar-mobile-top","navbar-main-left","navbar-main-right","content-wrapper"],d=0;d<a.length;d++)b.getElementById(a[d]).className+=" ios-margin";else b.getElementsByClassName("ios-status-bar")[0].className=""},1e3)}}}])}(upp,document,$UPP,window),function(a){"use strict";a.directive("rrssIconsTpl",["aboutService","config","device",function(a,b,c){return{restrict:"E",template:'<div class="rrss-icons-wrapper clearfix" ng-show="about.phone || about.email || about.location || config.eshop">   <div class="rrss-icons" >      <a class="rrss-icon rrss-icon-phone icon touchable" href="{{about.phone}}" ng-show="about.phone"></a>      <a class="rrss-icon rrss-icon-email icon touchable" href="mailto:{{about.email}}" target="_top"  ng-show="about.email"></a>      <a class="rrss-icon rrss-icon-location icon touchable" ng-href="{{about.location.url}}"  target="{{about.location.target}}"  ng-show="about.location"></a>      <a class="rrss-icon rrss-icon-eshop icon touchable" href="#!/eshop"  ng-show="config.eshop"></a>   </div></div>',replace:!0,link:function(d,e,f){d.config={},d.about=d.about||{};var g=function(a){var b;return a&&(b=1===a.length?{url:a[0].url,target:"_blank"}:{url:"#!/about/where",target:"_self"}),b},h=function(a){var b;return a&&(b=c.isMobile()?"tel:"+a:"#!/about/contact"),b};f.hideEshop||b.isAnActiveModule("eshop").then(function(){d.config.eshop=!0}),b.isAnActiveModule("about").then(function(){a.getInfo().then(function(a){a.contactEnabled&&(d.about.phone=h(a.phone),d.about.email=a.email),a.locationEnabled&&(d.about.location=g(a.locations))})})}}}])}(upp),function(a){"use strict";a.directive("infiniteScrollFunc",["translator",function(a){var b,c,d=function(){return b.get(0).scrollHeight>b.height()+200};return function(e,f,g){var h,i;b=b||$("#content-wrapper"),c=c||b[0];var j=function(){var a=g.infiniteScrollBusy;return function(){return!a||!e.$eval(a)}}(),k=function(){var a=g.infiniteScrollWithoutStopWhen;return function(){return e.$eval(a)}}(),l=function(){e.$eval(g.infiniteScrollFunc)};if(b.bind("scroll",function(){c.scrollTop+c.offsetHeight>=c.scrollHeight-50&&j()&&l()}),g.infiniteScrollWithoutInitWhen&&g.infiniteScrollWithoutStopWhen){var m=function(){var a=0,b=5;return function(){b>a&&!d()&&!k()&&(j()&&(a++,l()),setTimeout(m,100))}}();e.$watch(g.infiniteScrollWithoutInitWhen,function(a){a===!0&&m()})}if(g.infiniteScrollBusy&&(i=$("<div/>",{text:a.i18n("LOADING2")}).addClass("infinite-scroll-loading-data").appendTo(f),e.$watch(g.infiniteScrollBusy,function(a){a===!0?(h.hide(),i.show()):(i.hide(),h.show())})),g.infiniteScrollMoreButton){var n=$("<div/>").addClass("infinite-scroll-more-wrapper").appendTo(f);h=$("<button/>",{text:a.i18n("MORE_ELEMENTS")}).addClass("btn infinite-scroll-more").appendTo(n),h.click(function(){j()&&l()}),e.$watch(g.infiniteScrollMoreButton,function(a){a===!0?j()?(h.show(),i.hide()):(h.hide(),i.show()):(h.hide(),i.hide())})}}}])}(upp),function(a,b,c){"use strict";var d;a.directive("mainBody",["config",function(a){var e,f,g,h,i=function(a,b){return function(){a.state().state===b?a.close():a.open(b)}};return{restrict:"C",priority:1,controller:["$scope","$element","$rootScope","translator","$location","$q",function(b,c,e,f,g,j){e.changeNavText=function(a,b,d){if(!a||!b)throw new Error("no module neither text to show");var e,f=c.find('[data-mod-key="'+a+'"] .nav-opt-link');e=d?"left":"right",f.attr("data-upp-"+a+"-"+e,b)},e.changeActualOption=function(){var b,k,l=function(){i(d,"left")()},m=l,n=c.find("#navbar-mobile-top-current-section"),o=c.find("#navbar-mobile-top-back"),p=function(a){g.path(a),e.$apply()},q=function(b){var c,d=j.defer();if(c=b.i18n)d.resolve(f.i18n(c));else{if(c=b.moduleKey2Display)return a.getModuleDisplayText(c);(c=b.text)&&d.resolve(c)}return d.promise},r=function(a){k=k||$("html"),a?k.addClass("upp-home"):k.removeClass("upp-home")};return n.unbind("click").bind("click",function(){m&&m()}),o.unbind("click").bind("click",function(){m&&m()}),function(a,d){var e;if(!a)throw new Error("no name given");d?(m=function(){p(d)},h.hide(),o.show()):(m=l,o.hide(),h.show()),(e=a.navbarKey)?(b=b||c.find("#navbar-main"),b.find(".nav-opt[data-navbar-key]").removeClass("active"),b.find('.nav-opt[data-navbar-key="'+e+'"]').addClass("active"),r("home"===e)):r(!1),q(a).then(function(a){n.text(a)})}}()}],link:function(j,k){var l,m=k.find("#navbar-mobile-top-right-icon"),n=$("#templateCss");e=$(c),f=$(b),g=$("#main-container")[0];var o=-1!=c.location.search.indexOf("?debug=true");a.getTemplateCssPath(o).then(function(a){a&&n.attr("href",a)}),d=new Snap({element:g,maxPosition:200,minPosition:-200,flickThreshold:100,minDragDistance:10}),h=k.find("#navbar-mobile-top-left-icon");var p=function(){e.width()>$UPP.PROPS.ASIDE_NAVBAR_MAX_WIDTH?d.disable():d.enable()};e.resize(function(){clearTimeout(l),l=setTimeout(p,100)}),p();var q=function(a){return function(){a.close()}};f.on("click",'[data-menu-toggleable="S"]',q(d)),h.click(i(d,"left")),m.click(i(d,"right"))}}}]),a.directive("sideNavbarTpl",["config",function(a){return{restrict:"E",priority:2,templateUrl:"templates/app/navbar.html",replace:!0,link:function(b,c){var e,f=angular.forEach,g=$("#navbar-main-options"),h=$("#navbar-mobile-top-right-icon");a.shouldShowAccount().then(function(a){a||(g.remove(),h.remove(),d&&d.settings({disable:"right"}))}),a.getActiveModules().then(function(a){f(a,function(a){a.name&&a.display&&(e=c.find("[data-mod-key="+a.name+"]"),e.addClass("mod-active"),e.find(".nav-opt-link").text(a.display))})})}}}]),a.directive("adBannerTpl",function(){var a,b,c,d,e,f=$("#content"),g=function(){a.addClass("upp-ad").addClass("upp-ad-"+b)},h=function(){a.removeClass("upp-ad").removeClass("upp-ad-"+b)},i=function(a){e=e||$("#ad"),e.length&&(f.css("margin-bottom",a?a+"px":"0"),e.css("height",a?parseInt(a)+5+"px":"0"))},j=function(a){return'<div id="ad">   <iframe class="ad-iframe" src="templates/app/ads/'+c+".html?"+$.param(a)+'"  frameBorder="0" scrolling="no" width="100%"></iframe></div>'},k=function(){b&&(g(),i(d))},l=function(){b&&(h(),i())};return{restrict:"E",controller:["$scope","$element","$rootScope","config",function(e,f,g,h){a=$("html"),g.enableAds=k,g.disableAds=l,h.getAdProps().then(function(a){if(a){var e=a.name;("desktop"===e||"phone"===e||"tablet"===e)&&(b=a.name,d=a.heigth,c="mopub",f.replaceWith(j(a)))}})}]}})}(upp,document,window),function(a){"use strict";a.directive("previewCarouselSlider",function(){return{restrict:"C",scope:{images:"="},template:'<div class="flexslider">  <ul class="slides">    <li ng-repeat="image in images">        <img ng-src="{{image.url}}" />    </li>  </ul></div>',replace:!0,link:function(a,b,c){var d,e;a.$watch("images",function(a){if(a){if(d=c.previewType,!d)throw new Error("no type defined");if(a.length<1)throw new Error("no images");if("carousel"===d)a.length>1&&(e={animation:"slide",controlNav:!1,animationLoop:!1,slideshow:!1,itemWidth:80,itemMargin:5,asNavFor:"#slider"});else{if("slider"!==d)throw new Error("type of carousel-slider not recognized");e={animation:"slide",controlNav:!1,animationLoop:!1,slideshow:!1,sync:"#carousel"}}e?b.attr("id",d).flexslider(e):b.hide()}})}}})}(upp),function(a){"use strict";a.filter("i18n",["translator",function(a){return function(b,c){return a.i18n(b,c,void 0)}}]),a.filter("range",function(){return function(a,b){b=Number(b);for(var c=0;b>c;c++)a.push(c);return a}}),a.filter("sanitize",["utils",function(a){return function(b){return a.sanitize(b)}}]),a.filter("embedGoogleMap",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b+"&output=embed")}}])}(upp);var translations=translations||{};!function(a){"use strict";a.en={CLOSE:"Close",ERROR:"Error",OK:"Ok",REMOVE:"Remove",CANCEL:"Cancel",ON:"On",YES:"Yes",OFF:"Off",LOADING:"Loading",LOADING2:"Loading data...",MORE_ELEMENTS:"More elements",REQUIRED:"Required",HOME:"Home",POWERED_BY:"Powered by",HERE:"here",NETWORK_ERROR:"Network error. Please try again or contact your administrator.",LANG:"Language",SPANISH:"Spanish",ENGLISH:"English",SUAJILI:"Suajili","LOGIN.USER":"User","LOGIN.EMAIL":"Email","LOGIN.NAME":"First name","LOGIN.PHONE":"Phone","LOGIN.SURNAME":"Last name","LOGIN.CAPTCHA":"Captcha","LOGIN.PASSWORD":"Password","LOGIN.PASSWORD.CONFIRM":"Confirm Password","LOGIN.REMEMBER":"Remember","LOGIN.SIGNIN":"Sign in","LOGIN.SIGNOUT":"Sign out","LOGIN.GOTOLOGIN":"Go to login","LOGIN.FAIL.TITLE":"Error","LOGIN.FAIL":"Wrong username or password.","LOGIN.FAIL.MSG":"Please try again or contact your administrator.","LOGIN.NEEDED.TITLE":"Warning! Credentials needed to view this section.","LOGIN.NEEDED.MSG":'Please, click on "Go to login" button and sign in.',"LOGIN.HAVE_ACCOUNT":"Are you not registered? Sign up clicking","LOGIN.RESTORE_PASSWORD":"Have you forgotten your password? Restore it clicking","LOGIN.ERR.VALIDATION":"Invalid info:","LOGIN.ERR.VALIDATION.MSG":"Fields marked with X are invalid","LOGIN.ACCOUNT":"My account","LOGIN.ACCOUNT.HEADER":"Your account info","LOGIN.ACCOUNT.UPDATE-ACCOUNT":"Update","LOGIN.ACCOUNT.DELETE-ACCOUNT":"Remove account","LOGIN.ACCOUNT.OK":"Your account info has been updated","LOGIN.ACCOUNT.ERR.SERVER":"Error updating your account info.","LOGIN.ACCOUNT.ERR.SERVER.MSG.DEFAULT":"There has been an error processing your register","LOGIN.REGISTER":"Register","LOGIN.REGISTER.HEADER":"Register your new account!","LOGIN.REGISTER.CREATE-ACCOUNT":"Create my Account","LOGIN.REGISTER.OK":" You are almost in!","LOGIN.REGISTER.OK.MSG":"We will send you an email including the activation link to verify your account.","LOGIN.REGISTER.ERR.SERVER":"Error registering.","LOGIN.REGISTER.ERR.SERVER.MSG.DUPLICATED-EMAIL":"This email address has already been registered","LOGIN.REGISTER.ERR.SERVER.MSG.DEFAULT":"There has been an error processing your register","LOGIN.REGISTER.SUCCESS.MSG":"You have been successfully registered.","ADDRESS.NAME":"Street Address","ADDRESS.POSTAL-CODE":"Postal / Zip code","ADDRESS.CITY":"City","ADDRESS.STATE":"State / Prov. / Region","ADDRESS.COUNTRY":"Country","MY-ORDERS.MENU":"My orders","MY-ORDERS.TITLE":"My orders","MY-ORDERS.DATE":"Date","MY-ORDERS.PRICE":"Price","MY-ORDERS.SENT":"Sent","MY-ORDERS.SHIPPING":"Shipping Address","MY-ORDERS.BILLING":"Billing Address","MY-ORDERS.OBSERVATIONS":"Observations","MY-ORDERS.AMOUNT":"Amount","MY-ORDERS.PRODUCT":"Product","MY-ORDERS.SIZE":"Size","MY-ORDERS.COLOR":"Color","MY-ORDERS.UNIT-PRICE":"Price","MY-ORDERS.TOTAL-PRICE":"Total","MY-ORDERS.SHIPPING-CHARGES":"Shipping Charges","MY-ORDERS.PAYMENT_METHOD":"Payment method","MY-ORDERS.PAID_WITH_PAYPAL":"Paid with PayPal","MY-ORDERS.PAY_ON_DELIVERY":"Payment on delivery","MY-ORDERS.NO-ORDER":"There are no orders","ORDER.SHIPPING-CHARGES":"Shipping charges","RESTORE.TITLE":"Restore password","RESTORE.FAIL.MSG":"An user with the given email could not be found. Try it again.","RESTORE.FAIL":"Error","RESTORE.EMAIL":"Email","RESTORE.SUBMIT":"Restore","RESTORE.SUCCESS.MSG":"An email has been sent to your account so you can restore your password.","CHANGE_PASSWORD.TITLE":"New password","CHANGE_PASSWORD.FAIL.MSG":"There has been an error and we could not change your password.","CHANGE_PASSWORD.FAIL":"Error","CHANGE_PASSWORD.PASSWORD":"Password","CHANGE_PASSWORD.PASSWORD_REPEAT":"Repeat password","CHANGE_PASSWORD.SUBMIT":"Change password","CHANGE_PASSWORD.SUCCESS.MSG":"Password has been changed successfully.","HTTP.ERROR.1":"translate!!","HTTP.ERROR.2":"translate!!","HTTP.ERROR.3":"translate!!","HTTP.ERROR.4":"translate!!","HTTP.ERROR.5":"translate!!","HTTP.ERROR.6":"translate!!","HTTP.ERROR.7":"translate!!","HTTP.ERROR.8":"translate!!","HTTP.ERROR.9":"translate!!","HTTP.ERROR.10":"translate!!","HTTP.ERROR.11":"translate!!","HTTP.ERROR.12":"translate!!","HTTP.ERROR.13":"translate!!","HTTP.ERROR.14":"translate!!","HTTP.ERROR.15":"translate!!","HTTP.ERROR.16":"translate!!","HTTP.ERROR.17":"translate!!","HTTP.ERROR.18":"translate!!","HTTP.ERROR.19":"translate!!","HTTP.ERROR.20":"translate!!","HTTP.ERROR.21":"translate!!","HTTP.ERROR.22":"Indicated email address is incorrect.","HTTP.ERROR.23":"Indicated email address has already been registered.","HTTP.ERROR.24":"translate!!","HTTP.ERROR.25":"translate!!","HTTP.ERROR.26":"translate!!","HTTP.ERROR.27":"translate!!","HTTP.ERROR.28":"translate!!","HTTP.ERROR.29":"translate!!","HTTP.ERROR.30":"translate!!","HTTP.ERROR.31":"translate!!","HTTP.ERROR.32":"translate!!","HTTP.ERROR.33":"translate!!","HTTP.ERROR.34":"Captcha is incorrect.","HTTP.ERROR.35":"translate!!","HTTP.ERROR.36":"translate!!","HTTP.ERROR.37":"translate!!","HTTP.ERROR.38":"translate!!","HTTP.ERROR.39":"translate!!","HTTP.ERROR.112":"The website is unavailable.","HTTP.ERROR.123":"The website is temporarily unavailable.","HTTP.ERROR.124":"The website is temporarily unavailable.","HTTP.ERROR.DEFAULT":"There has been an error processing your request. Please try again or contact your administrator."}}(translations);var translations=translations||{};!function(a){"use strict";a.es={CLOSE:"Cerrar",ERROR:"Error",OK:"Ok",REMOVE:"Eliminar",CANCEL:"Cancelar",ON:"Sí",YES:"Sí",OFF:"No",LOADING:"Cargando",LOADING2:"Cargando datos...",MORE_ELEMENTS:"Más elementos",REQUIRED:"Requerido",HOME:"Inicio",POWERED_BY:"Creado con",HERE:"aquí",NETWORK_ERROR:"Error en la red. Por favor, inténtalo de nuevo o contacte con tu administrador.",LANG:"Idioma",SPANISH:"Español",ENGLISH:"Inglés",SUAJILI:"Suajili","LOGIN.USER":"Usuario","LOGIN.EMAIL":"Email","LOGIN.NAME":"Nombre","LOGIN.PHONE":"Teléfono","LOGIN.SURNAME":"Apellido","LOGIN.CAPTCHA":"Captcha","LOGIN.PASSWORD":"Contraseña","LOGIN.PASSWORD.CONFIRM":"Confirmar Contraseña","LOGIN.REMEMBER":"Recordar","LOGIN.SIGNIN":"Iniciar Sesión","LOGIN.SIGNOUT":"Cerrar Sesión","LOGIN.GOTOLOGIN":"Ir al login","LOGIN.FAIL.TITLE":"Error","LOGIN.FAIL":"Error en usuario o contraseña.","LOGIN.FAIL.MSG":"Lo sentimos, tu nombre de usuario y clave son incorrectos. Por favor, inténtelo de nuevo o contacte con tu administrador.","LOGIN.NEEDED.TITLE":"Atención! Necesitas iniciar sesión para ver esta sección.","LOGIN.NEEDED.MSG":"Por favor, haz click en login e inicia sesión.","LOGIN.RESTORE_PASSWORD":"¿No recuerdas tu contraseña? Restáurala pinchando","LOGIN.ERR.VALIDATION":"Información incorrecta:","LOGIN.ERR.VALIDATION.MSG":"Los campos marcados con X son erróneos","LOGIN.ACCOUNT":"Mi cuenta","LOGIN.ACCOUNT.HEADER":"Tu información de cuenta","LOGIN.ACCOUNT.UPDATE-ACCOUNT":"Guardar","LOGIN.ACCOUNT.DELETE-ACCOUNT":"Eliminar cuenta","LOGIN.ACCOUNT.OK":"Tu información ha sido guardada","LOGIN.ACCOUNT.ERR.SERVER":"Error guardando tus datos.","LOGIN.ACCOUNT.ERR.SERVER.MSG.DEFAULT":"Error realizando el registro","LOGIN.ACCOUNT.DELETE.MODAL.TITLE":"Eliminación de cuenta","LOGIN.ACCOUNT.DELETE.MODAL1.MSG":"Una vez que elimines tu cuenta no podrás recuperarla","LOGIN.ACCOUNT.DELETE.MODAL2.MSG":"¿Estás seguro?, ¡Tienes envíos pendientes, los perderás!","LOGIN.ACCOUNT.DELETE.MODAL.CONFIRM":"Sí, eliminar","LOGIN.HAVE_ACCOUNT":"¿No estás registrado? Regístrate pinchando","LOGIN.REGISTER":"Registro","LOGIN.REGISTER.HEADER":"¡Registra tu nueva cuenta!","LOGIN.REGISTER.TERMS.TEXT":"Acepto los ","LOGIN.REGISTER.TERMS.LINK":"términos y condiciones","LOGIN.REGISTER.CREATE-ACCOUNT":"Crear mi cuenta","LOGIN.REGISTER.OK":" ¡Ya te has registrado!","LOGIN.REGISTER.OK.MSG":"Te mandaremos un email con un link de activación para verificar tu cuenta.","LOGIN.REGISTER.ERR.SERVER":"Error registrándote.","LOGIN.REGISTER.ERR.SERVER.MSG.DUPLICATED-EMAIL":"Este email ya ha sido registrado","LOGIN.REGISTER.ERR.SERVER.MSG.DEFAULT":"Ha ocurrido un error procesando tu registro","LOGIN.REGISTER.SUCCESS.MSG":"Te has registrado correctamente.","ADDRESS.NAME":"Calle","ADDRESS.POSTAL-CODE":"Código Postal","ADDRESS.CITY":"Ciudad","ADDRESS.STATE":"Provincia","ADDRESS.COUNTRY":"País","MY-ORDERS.MENU":"Pedidos","MY-ORDERS.TITLE":"Pedidos","MY-ORDERS.DATE":"Fecha","MY-ORDERS.PRICE":"Precio","MY-ORDERS.SENT":"Enviado","MY-ORDERS.SHIPPING":"Dirección de envío","MY-ORDERS.BILLING":"Dir. de facturación","MY-ORDERS.OBSERVATIONS":"Observaciones","MY-ORDERS.AMOUNT":"Cantidad","MY-ORDERS.PRODUCT":"Producto","MY-ORDERS.SIZE":"Tamaño","MY-ORDERS.COLOR":"Color","MY-ORDERS.UNIT-PRICE":"Precio","MY-ORDERS.TOTAL-PRICE":"Total","MY-ORDERS.SHIPPING-CHARGES":"Gastos de envío","MY-ORDERS.PAYMENT_METHOD":"Método de pago","MY-ORDERS.PAID_WITH_PAYPAL":"Pago con PayPal","MY-ORDERS.PAY_ON_DELIVERY":"Pago contra-reembolso","MY-ORDERS.NO-ORDER":"No hay ningún pedido","RESTORE.TITLE":"Restaurar contraseña","RESTORE.FAIL.MSG":"No se ha podido encontrar un usuario asociado al email introducido. Inténtelo de nuevo.","RESTORE.FAIL":"Error","RESTORE.EMAIL":"Email","RESTORE.SUBMIT":"Restaurar","RESTORE.SUCCESS.MSG":"Se ha enviado un correo a tu cuenta para que puedas restaurar tu contraseña.","CHANGE_PASSWORD.TITLE":"Nueva contraseña","CHANGE_PASSWORD.FAIL.MSG":"Ha ocurrido un error, no hemos podido cambiar tu contraseña.","CHANGE_PASSWORD.FAIL":"Error","CHANGE_PASSWORD.PASSWORD":"Contraseña","CHANGE_PASSWORD.PASSWORD_REPEAT":"Repetir contraseña","CHANGE_PASSWORD.SUBMIT":"Cambiar contraseña","CHANGE_PASSWORD.SUCCESS.MSG":"Se ha cambiado correctamente tu contraseña.","HTTP.ERROR.1":"translate!!","HTTP.ERROR.2":"translate!!","HTTP.ERROR.3":"translate!!","HTTP.ERROR.4":"translate!!","HTTP.ERROR.5":"translate!!","HTTP.ERROR.6":"translate!!","HTTP.ERROR.7":"translate!!","HTTP.ERROR.8":"translate!!","HTTP.ERROR.9":"translate!!","HTTP.ERROR.10":"translate!!","HTTP.ERROR.11":"translate!!","HTTP.ERROR.12":"translate!!","HTTP.ERROR.13":"translate!!","HTTP.ERROR.14":"translate!!","HTTP.ERROR.15":"translate!!","HTTP.ERROR.16":"translate!!","HTTP.ERROR.17":"translate!!","HTTP.ERROR.18":"translate!!","HTTP.ERROR.19":"translate!!","HTTP.ERROR.20":"translate!!","HTTP.ERROR.21":"translate!!","HTTP.ERROR.22":"El email indicado es incorrecto.","HTTP.ERROR.23":"El email indicado ha sido registrado.","HTTP.ERROR.24":"translate!!","HTTP.ERROR.25":"translate!!","HTTP.ERROR.26":"translate!!","HTTP.ERROR.27":"translate!!","HTTP.ERROR.28":"translate!!","HTTP.ERROR.29":"translate!!","HTTP.ERROR.30":"translate!!","HTTP.ERROR.31":"translate!!","HTTP.ERROR.32":"translate!!","HTTP.ERROR.33":"translate!!","HTTP.ERROR.34":"Captcha incorrecto.","HTTP.ERROR.35":"translate!!","HTTP.ERROR.36":"translate!!","HTTP.ERROR.37":"translate!!","HTTP.ERROR.38":"translate!!","HTTP.ERROR.39":"translate!!","HTTP.ERROR.112":"La aplicación está dada de baja.","HTTP.ERROR.123":"La aplicación está temporalmente fuera de servicio.","HTTP.ERROR.124":"La aplicación está temporalmente fuera de servicio.","HTTP.ERROR.DEFAULT":"Ha ocurrido un error procesando tu petición. Por favor, inténtalo de nuevo o contacta con tu administrador."}}(translations),function(a){"use strict";a.service("analytics",["$http","device",function(a,b){var c,d=$UPP.PROPS.URL_ANALYTICS_REST_SERVICE,e=function(){c||a.post(d+"connection/in/",{device:{id:b.getDeviceId(),app:b.inPhonegap(),os:b.getOsName()?{name:b.getOsName()}:void 0}}).success(function(a){c=a.sessionId})},f=function(){return"undefined"!=typeof c};return{registerNewConnection:e,isSessionRegistered:f}}])}(upp),function(a){"use strict";a.service("_appi",["$rootScope","$http","location","utils",function(a,b,c,d){var e={path:function(a,b){c.path(a,b)},open:function(a){c.open(a)},openWindowAndListenUrlChangeInPhonegap:function(a,b){c.openWindowAndListenUrlChangeInPhonegap(a,b)}},f={showPageLoadingMsg:function(){a.showPageLoadingMsg()},hidePageLoadingMsg:function(){a.hidePageLoadingMsg()},showNetworkError:function(){a.showNetworkError()},changeNavText:function(b,c){a.changeNavText(b,c)},changeActualOption:function(b,c){a.changeActualOption(b,c)},showModalMessage:function(b){return a.showModalMessage(b)},showInlineMessage:function(b){a.showInlineError(b)}},g={getIdFromParams:function(a){return d.idFromParams(a)},navBarTemplate:function(a,b){return d.navBarTemplate(a,b)},breadCrumbTemplate:function(a,b,c){return d.breadCrumbTemplate(a,b,c)},broadcast:function(a){return d.broadcast(a)}},h={get:function(a,c){return b.get(a,c)},post:function(a,c,d){return b.post(a,c,d)},"delete":function(a,c){return b.delete(a,c)}};return{location:e,ui:f,utils:g,http:h}}]).service("appi",["_appi","security","securityUtils",function(a,b,c){var d=this;angular.copy(a,d),d.security={securable:function(a){return b.securable(a)}},d.http.getSecure=function(a){return d.http.get(a,c.getHttpAuthHeader())},d.http.postSecure=function(a,b){return d.http.post(a,b,c.getHttpAuthHeader())},d.http.deleteSecure=function(a){return d.http.delete(a,c.getHttpAuthHeader())}}])}(upp),function(a){"use strict";a.service("config",["$http","$q","$rootScope","device",function(a,b,c,d){var e,f,g=$UPP.PROPS.URL_UPPLICATION_REST_SERVICE+"app/config",h=$UPP.PROPS.URL_DASHBOARD_SERVICE+"preview-ajax",i={ad:"ad",logo:"logoPath",template:"templatePath",childuppName:"title",uppSignature:"uppSignature",content:"content",account:"account",background:"backgroundURL"},j=function(){return a.post(g,{device:d.getType()})},k=function(){return e||(e=j()),e},l=function(){var a=angular.forEach,b=function(b){var d=f.modules={};c.modules=[],a(b,function(a){d[a.name]={available:!0,display:a.display},c.modules.push({name:a.name,available:!0,display:a.display})})},d=function(a,b){f[a]=b[a]};return function(a){f={},b(a.modules);for(var c in i)i.hasOwnProperty(c)&&d(i[c],a)}}(),m=function(a){var c=b.defer(),d=function(){a?a(c,f):c.reject('don"t know how to be resolved')};return f?d():k().then(function(a){l(a.data),d()},function(a){c.reject(a)}),c.promise},n=function(a){return m(function(b,c){b.resolve(c[a])})},o=function(){var a,c=function(){var c=b.defer();k().then(function(a){c.resolve(a.data.modules)}),a=c.promise};return function(){return a||c(),a}}(),p=function(a){return m(function(b,c){var d,e=c.modules;e[a]&&(d=e[a].display),b.resolve(d)})},q=function(a){return m(function(b,c){var d=c.modules,e=d[a];e&&e.available===!0?b.resolve():b.reject("inactive")})},r=function(){return n(i.ad)},s=function(){return n(i.logo)},t=function(){return n(i.background)},u=function(c){if(c){var d=b.defer();return a.jsonp(h+"?callback=JSON_CALLBACK").then(function(a){a.data.template?d.resolve(a.data.template):n(i.template).then(function(a){d.resolve(a)})},function(a){d.reject(a)}),d.promise}return n(i.template)},v=function(){return n(i.childuppName)},w=function(){return n(i.content)},x=function(){return n(i.account)},y=function(){return n(i.uppSignature)},z=function(){var a=$UPP.HELPERS.isValInList;return function(){var c=b.defer();return k().then(function(){c.reject({})},function(b){b.data&&a(b.data.errorMessageCode,$UPP.PROPS.CHILDUPP_INACTIVE_CODES)?c.resolve(b.data.translatedErrorMessage):c.reject({warning:"config of childupp is not ok, but childupp is active"})}),c.promise}}();return{getActiveModules:o,getModuleDisplayText:p,isAnActiveModule:q,getAdProps:r,getLogoPath:s,getTemplateCssPath:u,isChilduppInactive:z,getChilduppName:v,shouldShowUppSignature:y,getContent:w,shouldShowAccount:x,getBackground:t}
}])}(upp),function(a,b,c,d,e){"use strict";a.service("device",[function(){var a,f,g="phone",h="desktop",i="tablet",j="xxx-xxx-xxxx",k="ios",l="android",m=e.touch,n=c.matchMedia("(max-width: 650px)").matches,o=function(){var a;return a=m?n?g:i:h},p=function(){var a,b=d.userAgent;return b.match(/Android/i)?a=l:b.match(/iPhone|iPad|iPod/i)&&(a=k),a};a=o(),f=p();var q=function(){return q=b.PHONEGAP||!1},r=function(){return a},s=function(){return a===g||a===i},t=function(){return m},u=function(){return c.device?c.device.uuid:j},v=function(){return f};return{inPhonegap:q,getType:r,isMobile:s,isTouchable:t,getDeviceId:u,getOsName:v}}])}(upp,$UPP.PROPS,window,navigator,Modernizr),function(a){"use strict";a.service("location",["$location","$window","$rootScope","device",function(a,b,c,d){var e=function(b,d){if(!b)throw new Error("Not url to open");a.path(b),d&&c.$apply()},f=function(a){if(!a)throw new Error("Not url to open");b.location.href=a},g=function(a,b,c){var d=function(a,b,c){return function(d){d.url.indexOf(b)>-1&&(c&&e(c,!0),a.close())}}(a,b,c),f=function(a){return function(){a.removeEventListener("loadstart",d),a.removeEventListener("exit",f)}}(a);a.addEventListener("loadstart",d),a.addEventListener("exit",f)},h=function(a,b){var c=window,d=angular.forEach,e=c.open(a,"_blank","location=no");b&&d(b,function(a){if(!a.urlListened)throw new Error("Phonegap listener without url to listen");g(e,a.urlListened,a.urlToOpen)})},i=function(a,b){if(!a)throw new Error("Not url to open");d.inPhonegap()?h(a,b):f(a)};return{path:e,open:f,openWindowAndListenUrlChangeInPhonegap:i}}])}(upp),function(a){"use strict";a.service("push",["$http","$q","device",function(a,b,c){var d,e=$UPP.PROPS.URL_UPPLICATION_REST_SERVICE+"app/push",f=(function(){var f,g=function(){var g=b.defer();(function(){return d||(d=a.post(e,{device:c.getDeviceId()})()),d})().then(function(){g.resolve()}),f=g.promise};return function(){return f||g(),f}}(),function(){return a.post(e,{device:c.getDeviceId()})});return{registerPush:f}}])}(upp),function(a){"use strict";var b,c=function(a){this.fn=a};c.prototype.intercept=function(a,b){this.fn(a,b)};var d=new c(function(a){b.set("shouldLoadFilters",-1!==a.indexOf("#!/eshop")?"true":"false")});a.service("routeInterceptorService",["storage",function(a){b=a;var c=[];return c.push(d),{intercept:function(a,b){for(var d=0,e=c.length;e>d;d++)c[d].intercept(a,b)}}}])}(upp),function(a,b){"use strict";a.service("storage",function(){function a(){var a=b.cookie;a.remove=b.removeCookie,this.set=function(b,c){a(b,c,{path:"/"})},this.remove=function(b){a.remove(b,{path:"/"})},this.get=function(b){return a(b)},this.removeAll=function(){var b=a();for(var c in b)b.hasOwnProperty(c)&&a.remove(c)}}function c(){var a=$UPP.PROPS.IDCHILDUPP,b=localStorage,c=function(b){return a+"_"+b};this.set=function(a,d){b.setItem(c(a),d)},this.remove=function(a){b.removeItem(c(a))},this.get=function(a){return b.getItem(c(a))},this.removeAll=function(){b.clear()}}var d;d=Modernizr.localstorage?new c:new a;var e=function(a,b){b||"number"==typeof b?d.set(a,b):d.remove(a)},f=function(a){return d.get(a)},g=function(a){d.remove(a)},h=function(){d.removeAll()};return{set:e,get:f,remove:g,removeAll:h}})}(upp,$),function(a){"use strict";a.service("translator",["tmhDynamicLocale",function(a){var b,c,d,e,f=$UPP.PROPS.DEFAULT_LANGUAGE||"es",g=translations,h={},i=function(){return window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage},j=function(a){f=a||f,b=g[f]||{},k(f)},k=function(){var i=function(a,i){var j;e=void 0,h={},(c=g[a])?(d=a,i&&(j=g[i])&&(e=i,h=j)):i?(c=g[i],d=i):(c=b,d=f)},j=function(b,c){c&&a.set(c.toLocaleLowerCase()),a.set(b.toLocaleLowerCase())};return function(a){var b;if(!a)throw new Error("not lang");var c=[];for(var d in g)g.hasOwnProperty(d)&&c.push(d);q(a)&&(b=r(a||a)),c.indexOf(a)<0&&(a=f),i(a,b),j(a,b)}}(),l=function(){return d},m=function(a,b){return a.replace(/\{(\w+)\}/g,function(a,c){var d=b[c];return void 0!=d&&d.toString().length>0?d:a})},n=function(a,d,e){var f=c[a]||h[a]||b[a]||a;return e&&d&&"number"==typeof d[0]?f=o(a,d[0]):d&&(f=m(f,d)),f},o=function(a,d){var e=a;if("number"==typeof d){var f=a+"("+d+")",g=c[f]||h[f]||b[f]||c[a]||h[a]||b[a]||a;e=m(g,[d])}return e},p=function(a){return a.split("-")},q=function(a){var b=p(a);return a&&2==b.length&&b[0].length>0&&b[1].length>0},r=function(a){var b=p(a);return b&&b[0]};return j(),k(i()),{_initLang:j,_detectUserLanguage:i,_isSublang:q,_getLangOfSublang:r,setLang:k,getLang:l,i18n:n,pluralizeI18n:o}}])}(upp),function(a){"use strict";a.service("utils",["$rootScope","translator",function(a,b){var c=function(a){if(a){for(var b,c=[" ","!","@","#","$","%","^","&","*","(",")","+","=","_","{","}","[","]","|","/","<",">",",",".","?","--"],d=0,e=c.length;e>d;d++)b=String(c[d]),a=a.replace(new RegExp("\\"+b,"g"),"-");a=a.toLowerCase()}else a="";return a},d=function(a,b){var c="";return a&&(b=b||"-",a.indexOf(b)>-1&&(a=a.split(b),c=a[a.length-1])),c},e=function(a){var b,c,d={},e=[],f=0;if(!(a instanceof Array))throw new Error("Input is not an array");for(b=a.length;b>f;++f)c=a[f],d.hasOwnProperty(c)||(e.push(c),d[c]=1);return e},f=function(){var a=function(a,b){for(var c,d="",e=0,f=b.length;f>e;e++){if(c=b[e],!(c.tab&&c.link&&c.label))throw new Error("without required info for this tab");d+='<li class="nav-opt ',c.tab===a&&(d+="active"),d+='"><a class="nav-opt-link" href="#!'+c.link+"\">{{'"+c.label+"' | i18n}}</a></li>"}return d};return function(b,c){var d="";if(!b)throw new Error("actual tab not found");return d='	<ul class="nav nav-pills nav-tabs-responsive">',d+=a(b,c),d+="	</ul>",d}}(),g=function(){var a=function(a,b,c){var d,e,f,g="",h="";if(a)for(d=0,f=a.length;f>d;d++){if(e=a[d],!e.link||!e.label)throw new Error("without required info to prev step");g+='       <li class="disabled"><a href="#!'+e.link+'">{{"'+e.label+'" | i18n}}</a>'+h+"</li>"}if(!(b.label&&b.actualCount&&b.totalCount))throw new Error("without required info to actual step");if(g+='       <li class="actual" data-actual="'+b.actualCount+'" data-total="'+b.totalCount+'">{{"'+b.label+'" | i18n}}'+(c?h:"")+"</li>",c)for(d=0,f=c.length;f>d;d++){if(e=c[d],!e.label)throw new Error("without required info to next step");g+='		<li class="disabled">{{"'+e.label+'" | i18n}}',d+1!=f&&(g+=h),g+="		</li>"}return g};return function(b,c,d){for(var e,f,g,h,i=0,j=c.length,k=[],l=[],m="";j>i;i++){if(f=c[i],b==f.step){for(g=f,e=i+1;j>e;e++)l.push(c[e]);break}k.push(f)}if(!g)throw new Error("actual step not found");if(g.actualCount=i+1,g.totalCount=j,m='<div class="breadcrumb">',m+="<ul>"+a(k,g,l)+"</ul>",h=g.next){if(!h.link&&!h.func||!h.label||!h.icon)throw new Error("'next step' info required");m+='<button type="button" class="btn btn-success btn-submit next" ',d&&(m+='ng-disabled="'+d+'" '),h.link?m+="onclick=\"location.href='#!"+h.link+"'\"":h.func&&(m+='ng-click="'+h.func+'"'),m+='>{{"'+h.label+'" | i18n}}<i class="'+h.icon+'"></i></button>'}return m+="</div>"}}(),h=function(b,c){b&&(b="event:"+b,a.$broadcast(b,c))},i=function(a){var c,d,e="HTTP.ERROR.";return a||(a="DEFAULT"),c=e+a,d=b.i18n(c),d===c&&(d=b.i18n(e+"DEFAULT")),d};return{sanitize:c,idFromParams:d,getUnique:e,breadCrumbTemplate:g,navBarTemplate:f,broadcast:h,i18nHttpErrorCode:i}}])}(upp);var $UPP=$UPP||{};$UPP.HELPERS=$UPP.HELPERS||{},function(){"use strict";var a=this;a.getWindowParams=function(a){var b={};return a.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,c,d){b[c]=d}),b},a.isValInList=function(a,b){for(var c=0,d=b.length;d>c;c++)if(a===b[c])return!0;return!1}}.call($UPP.HELPERS),function(a){"use strict";a.service("accountManager",["$http","$location","$q","utils","$rootScope","appi",function(a,b,c,d,e,f){var g=$UPP.PROPS.URL_UPPLICATION_REST_SERVICE+"users/",h=function(a,b,c,d,e,h){if(a&&b&&c&&e){var i={name:a,surname:b,email:c,phone:d,password:e,address:h};return f.http.post(g+"register",i)}throw new Error("required data not found")},i=function(a,b,c,d,e){if(a){var h={password:a,address:b,name:c,surname:d,phone:e};return f.http.postSecure(g+"account",h)}throw new Error("required data not found")},j=function(){return f.http.getSecure(g)},k=function(){return f.http.get(g+"captcha")},l=function(){return f.http.deleteSecure(g+"user")};return{register:h,update:i,remove:l,retrieve:j,getCaptchaImg:k}}]),a.config(["$routeProvider",function(a){a.when("/login/account",{templateUrl:"templates/plugins/login/account.html",resolve:{loadSecurity:["security",function(a){return a.initialize()}]}}).when("/register",{templateUrl:"templates/plugins/login/register.html"}).when("/register/ok",{templateUrl:"templates/plugins/login/register-ok.html"})}]),a.factory("accountStatusMessageHandler",["translator",function(a){function b(a,b,c){this.$scope=a,this.scopeErrorVar=b,this.scopeOkVar=c}var c=function(b,c){var d="",e=typeof c;c&&("object"===e&&c.translatedErrorMessage?d=c.translatedErrorMessage:"string"===e&&(d=a.i18n(c))),this.$scope[this.scopeErrorVar]={title:a.i18n(b),msg:d}},d=function(){this.$scope[this.scopeErrorVar]=void 0},e=function(){this.$scope[this.scopeOkVar]=!0},f=function(){this.$scope[this.scopeOkVar]=!1},g=function(){var a=angular.bind;return function(g,h,i){if(g){if(h||i){var j=new b(g,h,i);return h&&(j.showError=a(j,c),j.hideError=a(j,d)),i&&(j.showOk=a(j,e),j.hideOk=a(j,f)),j}throw new Error("handlers not found")}throw new Error("$scope not found")}}();return{create:g}}]),a.controller("upp.login.RegisterCtrl",["$rootScope","$scope","accountManager","appi","accountStatusMessageHandler","$timeout",function(a,b,c,d,e,f){var g=e.create(b,"registerError");b.register=function(a){a?(d.ui.showPageLoadingMsg(),c.register(b.name,b.surname,b.email,b.phone,b.password,b.address).success(function(){d.location.path("/register/ok"),d.ui.hidePageLoadingMsg()}).error(function(a){g.showError("LOGIN.REGISTER.ERR.SERVER",a),b.submitted=!1,d.ui.hidePageLoadingMsg()})):(b.submitted=!0,g.showError("LOGIN.ERR.VALIDATION","LOGIN.ERR.VALIDATION.MSG"))},d.ui.changeActualOption({i18n:"LOGIN.REGISTER",navbarKey:"register"}),f(function(){a.closeSpin()},1e3)}]),a.controller("upp.login.AccountCtrl",["$scope","accountManager","security","appi","accountStatusMessageHandler","ordersService","contextHolderManager",function(a,b,c,d,e,f,g){var h=e.create(a,"updateError","updateOk"),i=function(c){h.hideOk(),h.hideError(),c?(d.ui.showPageLoadingMsg(),b.update(a.password,a.address,a.name,a.surname,a.phone).success(function(a){a&&a.token&&g._setToken(a.token),h.showOk(),d.ui.hidePageLoadingMsg()}).error(function(b){h.showError("LOGIN.ACCOUNT.ERR.SERVER",b),a.submitted=!1,d.ui.hidePageLoadingMsg()})):(a.submitted=!0,h.showError("LOGIN.ERR.VALIDATION","LOGIN.ERR.VALIDATION.MSG"))},j=function(){var a=d.ui.showModalMessage,e=function(){a({title:"LOGIN.ACCOUNT.DELETE.MODAL.TITLE",message:"LOGIN.ACCOUNT.DELETE.MODAL1.MSG",closeButton:{text:"CANCEL"},confirmButton:{text:"LOGIN.ACCOUNT.DELETE.MODAL.CONFIRM",callback:g}})},g=function(){f.hasPendingOrders().then(function(a){a?setTimeout(h,500):j()},function(){d.ui.showNetworkError()})},h=function(){a({title:"LOGIN.ACCOUNT.DELETE.MODAL.TITLE",message:"LOGIN.ACCOUNT.DELETE.MODAL2.MSG",closeButton:{text:"CANCEL"},confirmButton:{text:"LOGIN.ACCOUNT.DELETE.MODAL.CONFIRM",callback:i}})},i=function(){j()},j=function(){b.remove().then(function(){c.logout()},function(){d.ui.showNetworkError()})};return function(){e()}}();c.securable({scope:a}).then(function(){d.ui.changeActualOption({i18n:"LOGIN.ACCOUNT"}),d.ui.showPageLoadingMsg(),b.retrieve().success(function(b){a.name=b.name,a.surname=b.surname,a.email=b.email,a.phone=b.phone,a.password=b.password,a.passwordConfirm=b.password,a.address=null==b.address?{}:b.address,a.update=i,a.delete=j,d.ui.hidePageLoadingMsg()}).error(function(){d.ui.showNetworkError()})})}]),a.directive("userDataTpl",function(){var a=angular.forEach;return{restrict:"E",templateUrl:"templates/plugins/login/user-data.html",replace:!0,link:function(b,c,d){if(d.fieldsRo){var e=d.fieldsRo.split(",");a(e,function(a){c.find("#"+a.trim()).prop("disabled",!0)})}d.requireCaptcha?b.captchaRequired=!0:c.find("#captchaControl").remove()}}})}(upp),function(a){"use strict";a.controller("upp.plugins.login.ChangePasswordCtrl",["$rootScope","$routeParams","location","$timeout",function(a,b,c,d){var e=b.token;e&&d(function(){a.$broadcast("changePasswordModal:open",{token:atob(e)})},1e3),c.path("/")}])}(upp),function(a){"use strict";a.directive("modalChangePasswordTpl",["$timeout","restoreService",function(a,b){var c,d,e=function(e){b.changePassword(e.password,d).then(function(){e.changeError=!1,e.changeSuccess=!0,a(function(){c.modal("hide")},2e3)},function(){e.restoreError=!0})},f=function(a){a.changeError=!1,a.changeSuccess=!1,a.password="",a.passwordRepeat=""};return{restrict:"E",replace:!0,templateUrl:"templates/plugins/login/modal-change-password-tpl.html",controller:["$scope",function(a){a.email="",a.changePassword=function(){e(a)}}],link:function(b,g){b.$on("changePasswordModal:open",function(h,i){c=c||g,d=i.token,f(b),b.email="",c.modal("show"),c.one("shown",function(){$("#password, #repeat-password").unbind("mouseup mousedown")}),c.one("hidden",function(){a(function(){b.$broadcast("changePasswordModal:close")},500)}),c.unbind("keypress").bind("keypress",function(a){13==a.which&&(a.preventDefault(),e(b))}),b.$on("changePasswordModal:close",function(){c.modal("hide")})})}}}])}(upp),function(a){"use strict";a.directive("modalEmailRestoreTpl",["$timeout","restoreService",function(a,b){var c,d=function(d){b.restorePassword(d.email).then(function(){d.restoreError=!1,d.restoreSent=!0,a(function(){c.modal("hide")},2e3)},function(){d.restoreError=!0})},e=function(a){a.restoreError=!1,a.restoreSent=!1,a.email=""};return{restrict:"E",replace:!0,templateUrl:"templates/plugins/login/modal-email-restore-tpl.html",controller:["$scope",function(a){a.email="",a.restore=function(){d(a)}}],link:function(b,f){b.$on("emailRestore:open",function(){c=c||f,e(b),b.email="",c.modal("show"),c.one("shown",function(){$("#email").unbind("mouseup mousedown")}),c.one("hidden",function(){a(function(){b.$broadcast("emailRestore:close")},500)}),c.unbind("keypress").bind("keypress",function(a){13==a.which&&(a.preventDefault(),d(b))}),b.$on("emailRestore:close",function(){c.modal("hide")})})}}}])}(upp),function(a){"use strict";a.directive("modalUserActivatedSuccessTpl",["$timeout",function(a){var b;return{restrict:"E",replace:!0,templateUrl:"templates/plugins/login/modal-user-activated-success-tpl.html",link:function(c,d){c.$on("registerSuccess:open",function(){b=b||d,b.modal("show"),b.one("hidden",function(){a(function(){c.$broadcast("emailRestore:close")},500)}),c.$on("registerSuccess:close",function(){b.modal("hide")})})}}}])}(upp),function(a){"use strict";var b={authenticated:"login:authenticated",no_more_authenticated:"login:no_more_authenticated",open_login:"login:open-login",close_login:"login:close-login",close:"login:close"};a.factory("authenticationBuilder",function(){function a(a,b,c){this.username=a,this.principal=b,this.type=c}function b(a,b){this.username=a,this.password=b,this.type="UsernamePassword"}function c(a){this.username=void 0,this.token=a,this.type="Token"}function d(a,b,c,d,e,f){this.username=a,this.userId=c,this.admin=d,this.token=e,this.password=b,this.username_display=f}return a.prototype.isLogged=function(){return void 0!==this.principal},a.prototype.hasRole=function(){return!0},b.prototype.isLogged=function(){return!1},b.prototype.hasRole=function(){return!1},c.prototype.isLogged=function(){return!1},c.prototype.hasRole=function(){return!1},d.prototype.isAdmin=function(){return this.admin&&"boolean"==typeof this.admin},{build:function(b,c,e,f,g,h){var i=void 0;if(b){var j=!1,k=-1;e&&(j=e),c&&(k=c),i=new d(b,void 0,k,j,f,h)}return new a(b,i,g)},usernamePassword:function(a,c){return new b(a,c)},token:function(a){return new c(a)},anonymous:function(){return new a(void 0,void 0,"anonymous")}}}),a.service("contextHolderManager",["storage","authenticationBuilder",function(a,b){var c=function(){var c=void 0,d={authentication:b.anonymous()},e="upplicationToken",f=function(){return d},g=function(a){d.authentication=a,a.isLogged()||h(void 0)},h=function(b){c=b,a.set(e,b)},i=function(){return c||a.get(e)};return{get:f,setToken:h,getToken:i,setAuthentication:g}}();return{_setAuthentication:c.setAuthentication,_setToken:c.setToken,_getToken:c.getToken,get:c.get}}]),a.service("authManager",["$q","$http","securityUtils","utils","authenticationBuilder","contextHolderManager",function(a,b,c,d,e,f){var g=$UPP.PROPS.URL_UPPLICATION_REST_SERVICE+"users/",h=function(a,b){var c=a.data;return e.build(c.username,c.idUsuario,c.admin,c.token,b,c.username_display)},i=function(){return e.anonymous()},j=function(){var b=a.defer(),c=b.promise;return b.resolve(i()),c},k=function(){var a=function(a,c){return b.post(g+"login",{username:a,password:c})},d=function(b){return b&&b.username&&b.password?a(b.username,b.password).then(function(a){return h(a,"UsernamePassword")}):j()},e=function(){return b.post(g+"logout",{},c.getHttpAuthHeader()).then(function(){return i()})},f=function(a){return void 0!==a&&"UsernamePassword"===a.type};return{login:d,logout:e,check:f}}(),l=function(){var a=function(a){return b.post(g+"loginToken",{token:a})},d=function(b){return b&&b.token?a(b.token).then(function(a){return h(a,"Token")}):j()},e=function(){return b.post(g+"logout",{},c.getHttpAuthHeader()).then(function(){return i()})},f=function(a){return void 0!==a&&"Token"===a.type};return{login:d,logout:e,check:f}}(),m=function(a){var b=function(a){f._setAuthentication(a),void 0!==a.principal&&void 0!==a.principal.token&&f._setToken(a.principal.token)},c=function(){var a=i();f._setAuthentication(a)};return k.check(a)?k.login(a).then(function(a){return a.isLogged()?b(a):c(),a},function(){return c(),e.anonymous()}):l.check(a)?l.login(a).then(function(a){return a.isLogged()?b(a):c(),a},function(){return c(),e.anonymous()}):j().then(function(){return c(),e.anonymous()})},n=function(){var a=i();f._setAuthentication(a)},o=function(a){return k.check(a)?k.logout(a).then(function(a){return n(),a}):l.check(a)?l.logout(a).then(function(a){return n(),a}):j().then(function(){return n(),e.anonymous()})};return{login:m,logout:o}}]),a.service("securityUtils",["contextHolderManager",function(a){var b=function(){return a.get().authentication.isLogged()?{headers:{Authorization:"BASIC "+a._getToken()}}:void 0};return{getHttpAuthHeader:b}}]),a.service("security",["$location","$q","utils","$rootScope","contextHolderManager","authenticationBuilder","loginManager","authManager",function(a,c,d,e,f,g,h,i){var j=function(c,d){var e;c&&c.isLogged()&&d&&(e=d.scope)&&e.$on("event:"+b.no_more_authenticated,function(){a.path("/")})},k=function(){var a=c.defer(),b=a.promise;return a.resolve(g.anonymous()),b},l=function(a){var b=c.defer(),d=b.promise;return b.resolve(a),d},m=function(){var a=f.get().authentication;if(a.isLogged())return l(a);if(void 0===f._getToken())return k();var b=g.token(f._getToken());return i.login(b)},n=function(){return m()},o=function(b){return m().then(function(d){return d.isLogged()?d:b&&b.showError===!1?h.login():h.login().then(function(b){return b.isLogged()||"/register"===a.path()?b:(a.path("login/needed"),c.reject())})},function(){return h.login()}).then(function(a){return j(a,b),a})};return{initialize:m,securable:o,getAuthentication:n,login:i.login,logout:i.logout}}]),a.service("loginManager",["$q","$rootScope","contextHolderManager",function(a,c,d){var e=function(){f();var e=a.defer(),g=e.promise,h=c.$on("event:"+b.close,function(){e.resolve(d.get().authentication),j()}),i=c.$on("event:"+b.authenticated,function(a,b){e.resolve(b),j()}),j=function(){h(),i()};return g},f=function(){c.$broadcast("event:"+b.open_login)},g=function(){c.$broadcast("event:"+b.close_login)};return{show:f,login:e,close:g}}]),a.service("signinManager",["authManager","authenticationBuilder","contextHolderManager","loginManager",function(a,b,c,d){var e=function(c,d){var e=b.usernamePassword(c,d);return a.login(e)},f=function(){var b=c.get().authentication;return a.logout(b)},g=function(){d.show()};return{login:e,logout:f,open:g}}]),a.config(["$routeProvider",function(a){a.when("/login/needed",{templateUrl:"templates/plugins/login/login-needed.html"})}]),a.controller("upp.login.SigninCtrl",["$scope","signinManager","security","contextHolderManager",function(a,b,c,d){a.openLogin=function(){b.open()},a.logout=function(){b.logout()},c.initialize().then(function(){a.context=d.get()}),a.isLogged=function(){return a.context&&a.context.authentication&&a.context.authentication.isLogged()}}]),a.directive("modalLoginTpl",["signinManager","utils","$timeout",function(a,c,d){var e,f=function(a){a.loginError=!1,a.username="",a.pass="",a.remember=!1},g=function(b){b.loginError=!1,b.hideError=function(){b.loginError=!1},a.login(b.username,b.pass,b.remember).then(function(a){a.isLogged()?(e.modal("toggle"),b.loginError=!1):b.loginError=!0})};return{restrict:"E",replace:!0,templateUrl:"templates/plugins/login/login.html",controller:["$scope","location",function(a,b){a.checkLogin=function(){g(a)},a.openRestoreModal=function(){d(function(){a.$broadcast("emailRestore:open")},600)},a.redirectToRegister=function(){b.path("register")}}],link:function(a,h){a.$on("event:"+b.open_login,function(){e=e||h,f(a),e.modal("show"),e.one("shown",function(){$("#username, #pass").unbind("mouseup mousedown")}),e.one("hidden",function(){d(function(){c.broadcast(b.close)},500)}),e.unbind("keypress").bind("keypress",function(b){13==b.which&&(b.preventDefault(),g(a))}),a.$on("event:"+b.close_login,function(){e.modal("hide")})})}}}])}(upp),function(a,b){"use strict";var c=b.PROPS.URL_UPPLICATION_REST_SERVICE+"users";a.service("restoreService",["appi","$q",function(a,b){var d=function(d){var e=b.defer();return a.http.post(c+"/password/restore/email",{email:d}).then(function(){e.resolve(!0)},function(a){e.reject(a)}),e.promise},e=function(d,e){var f=b.defer();return a.http.post(c+"/password/change",{password:d,token:e}).then(function(){f.resolve(!0)},function(a){f.resolve(a)}),f.promise};return{restorePassword:d,changePassword:e}}])}(upp,$UPP),function(a){"use strict";a.controller("upp.plugins.orders.OrdersCtrl",["$scope","ordersService","appi",function(a,b,c){c.security.securable({scope:a}).then(function(){c.ui.changeActualOption({i18n:"MY-ORDERS.TITLE"}),c.ui.showPageLoadingMsg(),a.$PAYMENT_PAYPAL=1,a.$PAYMENT_REFUND=2,b.listOrders().then(function(d){var e=d.data;a.loaded=!0,a.orders=e.orders,a.currency=e.currency,c.ui.hidePageLoadingMsg(),a.openDetail=function(a){a.detailed?a.showDetail=!a.showDetail:b.retrieveOrder(a.id).then(function(b){var c=b.data;a.products=c.products,a.billingAddress=c.billingAddress,a.sendAddress=c.sendAddress,a.notes=c.notes,a.shippingCharges=c.shippingCharges,a.price=c.price,a.paymentModel=c.paymentModel,a.detailed=!0,a.showDetail=!0},function(){})}},function(){c.ui.showNetworkError()})})}])}(upp),function(a){"use strict";a.config(["$routeProvider",function(a){a.when("/account/orders",{templateUrl:"templates/plugins/orders/orders.html",showAd:!0})}])}(upp),function(a){"use strict";a.service("ordersService",["$q","appi",function(a,b){var c=$UPP.PROPS.URL_UPPLICATION_REST_SERVICE+"orders",d=function(){return b.http.getSecure(c)},e=function(a){return b.http.getSecure(c+"/"+a)},f=function(){var d=a.defer();return b.http.getSecure(c+"/pending").then(function(a){var b=a.data&&a.data.orders&&a.data.orders.length;d.resolve(b)},function(a){d.reject(a)}),d.promise};return{listOrders:d,retrieveOrder:e,hasPendingOrders:f}}])}(upp),function(a,b){"use strict";a.controller("upp.plugins.products.CatalogCtrl",["$scope","appi","$injector","catalogFiltersService","$timeout",function(a,c,d,e,f){if("function"!=typeof a.listProducts)throw new Error("'listProducts' function not defined");var g,h,i=-1,j=1;a.retrieveFilters=function(){var b=e.get();b&&(i=Number(b.price),a.priceFilter=1===i?"ASC":0===i?"DESC":"",b.category&&a.$on("catalog:categoriesLoaded",function(c,d){for(var e=0,f=a.categories.length;f>e;e++)a.categories[e].id===Number(b.category)&&(a.category=a.categories[e]);d.callback(a.category)}),b.subcategory&&a.$on("catalog:subcategoriesLoaded",function(c,d){f(function(){for(var c=0,e=a.subcategories.length;e>c;c++)a.subcategories[c].id===Number(b.subcategory)&&(a.subcategory=a.subcategories[c]);d.callback(a.subcategory)},500)}),a.filters||(a.filters={}),b.name&&(a.filters.name=b.name))},a.retrieveFilters();var k=function(){var b=0,c=0,d=i,g="";a.category&&(b=a.category.id),a.subcategory&&(c=a.subcategory.id),f(function(){a.filters&&(g=a.filters.name||""),e.set(b,c,d,g)},100)};a.updateFiltersCache=k;var l=function(){k(),a.more=!0,a.busy=!0,c.ui.showPageLoadingMsg();var b={filter:h};i>=0&&(b.order=i),a.listProducts(b).then(function(b){a.products=b.products,a.currency=b.currency,a.loaded=!0,a.busy=!1,c.ui.hidePageLoadingMsg(),g&&g(b.products.length,b.request)},function(){c.ui.showNetworkError()})};l(),a.infiniteScroll&&(g=function(){var b=Number;return function(c,d){a.more=c>0&&b(d.total)>b(d.currentPage)*b(d.maxRows)}}(),a.retrieveMoreProducts=function(){var c=b.forEach;return function(){if(a.loaded&&a.more){a.busy=!0;var b={pagination:{page:++j},filter:h};i>=0&&(b.order=i),a.listProducts(b).then(function(b){a.busy=!1,c(b.products,function(b){a.products.push(b)}),g(b.products.length,b.request)})}}}()),a.add2cart=function(b){var c=d.get("cartService");c.add(b,a.currency)},a.setFilter=function(a){h=a,l(),j=1},a.setOrder=function(a){switch(a){case"ASC":i=1;break;case"DESC":i=0;break;default:i=-1}l(),j=1},a.allProductsProductsHavePrice=function(){if(a.products){for(var b=0,c=0,d=a.products.length;d>c;c++)b+=a.products[c].price;return b>0}return!1}}])}(upp,angular),function(a){"use strict";a.directive("productsAttributesFilterTpl",[function(){return{restrict:"E",templateUrl:"templates/plugins/products/products-attributes_filter.html",replace:!0}}])}(upp),function(a){"use strict";a.directive("productsCatalogAttributesSelectorTpl",[function(){var a=$UPP.PROPS.CONF.MODULES.ESHOP.ADD2CART_AVAILABLE,b=function(){return a?'<div class="catalog-product-attributes-selector" ng-show="product.goToBasket">   <products-product-attributes-selector-tpl class="item-box" data-amount="product.selectedStock" data-max-stock="product.maxStock" data-attribute="product.selectedAttribute" data-attributes="product.attributes" data-no-stock="product.noStock" style="display: none;">        <button type="button" class="close">&times;</button>   </products-product-attributes-selector-tpl>   <input type="button" class="btn btn-large product-preCart"       value="{{\'PRODUCTS.CATALOG.TOCART.PRECONFIRM\' | i18n}}"/>   <input type="button" class="btn btn-large product-toCart"       value="{{\'PRODUCTS.CATALOG.TOCART.CONFIRM\' | i18n}}"       ng-disabled="!product.isProductOrderOk()" style="display: none"       ng-click="add2cart(product)"/></div>':""};return{restrict:"E",replace:!0,template:b(),link:function(b,c){if(!a)return void c.remove();var d,e,f,g,h=$(".product-preCart",c),i=function(){d.hide(),e.hide(),h.show()},j=function(){d=$(".product-toCart",c),d.click(function(){i()})},k=function(){e=$(".product-attributes-selector",c)},l=function(){f=$(".close",c),f.click(function(){i()})},m=function(){f||l(),e||k(),d||j(),g=!0};h.click(function(){g||m(),e.show(),d.show(),h.hide()})}}}])}(upp),function(a){"use strict";a.directive("productsCategoryFilterTpl",[function(){return{restrict:"E",templateUrl:"templates/plugins/products/products-category_filter.html",replace:!0,controller:["$scope","$element","$attrs","productsCategoriesService",function(a,b,c,d){var e=function(b){var d,e=a.$eval(c.filterFunc);return function(a,c){e(a?a.id:c?b:d),c&&a&&(d=a.id)}}(),f=function(b){e(b,!0),b&&b.id&&d.listChildrenOfParent(b.id).then(function(b){b.data.length&&(a.subcategories=b.data,a.$broadcast("catalog:subcategoriesLoaded",{callback:g}),a.selectSubcategory=g)})},g=function(a){e(a,!1)};d.listParents().then(function(b){b.data.length&&(a.categories=b.data,a.$broadcast("catalog:categoriesLoaded",{callback:f}),a.selectCategory=f)})}]}}])}(upp),function(a){"use strict";a.directive("productsPricesTpl",["$filter",function(a){var b=angular.forEach,c=function(c,d,e){var f,g=function(b,c){return a("number")(b)+"&nbsp;"+c},h="",i="",j=!1;return b(d,function(a){"2x1"===a.type?h+='<span class="price promotion price-2x1 badge badge-important">2x1</span>':"OF_PERCENT"===a.type&&(j=!0,i+='<span class="price promotion price-new">'+g(a.newPrice,e)+"</span>")}),f='<span class="price '+(j?"price-old":"price-actual")+'">'+g(c,e)+"</span>",'<div class="product-prices">'+h+f+i+"</div>"};return{restrict:"E",scope:{price:"=",promotions:"=",currency:"="},replace:!0,link:function(a,b){var d=function(){if(a.price){var d=c(a.price,a.promotions,a.currency);b.replaceWith(d)}};a.$watch("price",function(a){a?d():null===a&&b.remove()}),a.$watch("promotions",function(a){a&&a.length&&d()})}}}])}(upp),function(a){"use strict";a.directive("productsProductAttributesSelectorTpl",["translator",function(a){var b=$UPP.PROPS.CONF.MODULES.ESHOP.ADD2CART_AVAILABLE,c=function(){return b?"templates/plugins/products/products-product_attributes_selector.html":""};return{restrict:"E",replace:!0,transclude:!0,scope:{attributes:"=",attribute:"=",amount:"=",maxStock:"=",noStock:"=",basket:"="},templateUrl:c(),link:function(c,d){if(!b)return void d.remove();c.noStock=!0,c.hasSizes=!1,c.hasColors=!1,c.sizes=[],c.colors=[],c.maxStock=0;var e=function(b){var e,f,g,h,i=b[0],j=!1,k=!1,l=[],m=[],n=[],o=!1,p={}.hasOwnProperty,q=d.find(".product-amount input"),r=function(a){var b=-1,d=0,h=a.length;for(d;h>d;d++)i=a[d],f=i.size,p.call(n,f)?n[f].options.push(i):(e={id:f,size:f,options:[i]},l.push(e),n[f]=e,c.attribute&&f===c.attribute.size&&(b=l.length-1));b>-1&&(g=l[b])},s=function(){var b="PRODUCTS.PRODUCT.TOOMUCHAMOUNT";a&&(b=a.i18n(b)),q.tooltip({title:b,placement:"top",trigger:"manual"})},t=function(a){var b,d=c.attribute.color.id,e=-1,g=0,h=a.length;for(g;h>g;g++)if(f=a[g].color.id,f==d){e=g;break}return e>-1&&(b=a[e]),b},u=function(a){m=a,c.attribute&&(h=t(m))},v=function(a){var b=a.stock;b>0?(c.attribute=a,c.maxStock=b,c.noStock=!1):(c.attribute=null,o=!0,c.noStock=o)};i.size&&(j=!0),i.color&&(k=!0),j?r(b):k?u(b):v(i),c.$watch("size",function(a,b){if(a)if(k){var d=a.options;c.colors=d,c.stocks=null,c.noStock=!1,b&&a!==b?(c.color=null,c.amount=null):c.attribute&&(c.color=t(d))}else v(a.options[0])}),c.$watch("color",function(a,b){a&&(b&&a!==b&&(c.amount=null),v(a),c.style=a.color.colorHex)}),c.$watch("amount",function(a){a&&0!==c.maxStock&&q.tooltip(a>c.maxStock?"show":"hide")}),j&&(c.hasSizes=j,c.sizes=l,c.size=g),k&&(c.hasColors=k,c.colors=m,c.color=h),c.noStock=o,s()};c.$watch("attributes",function(a){a&&a.length?e(a):c.noStock=!0}),c.colorMustBeEnabled=function(){return!c.hasSizes||c.size},c.amountMustBeEnabled=function(){return!c.hasSizes&&!c.hasColors&&!c.noStock||c.hasSizes&&!c.hasColors&&c.size&&c.size.options[0].stock>0||c.hasColors&&!c.hasSizes&&c.color&&c.color.stock>0||c.hasSizes&&c.hasColors&&c.size&&c.color&&c.color.stock>0}}}}])}(upp),function(a){"use strict";a.directive("productsCatalogTpl",[function(){return{restrict:"E",templateUrl:"templates/plugins/products/products-catalog.html",replace:!0}}])}(upp),function(a){"use strict";var b=angular.forEach;a.factory("productsDao",["$q","appi","product",function(a,c,d){function e(b){var d=this;d.urlApiRestServer=b,d.$q=a,d.httpGet=c.http.get}e.prototype.listProducts=function(a){var c,e=this,f=e.$q.defer(),g="",h=function(){g+=g.length?"&":"?"};return a&&(c=a.filter)&&c.field&&c.key&&(h(),g+="filterField="+c.field+"&filterKey="+c.key),a&&(c=a.sort)&&c.index&&c.order&&(h(),g+="sortIndex="+c.index+"&sortOrder="+c.order),a&&(c=a.pagination)&&c.currentPage&&c.maxRows&&(h(),g+="currentPage="+c.currentPage+"&maxRows="+c.maxRows),a&&a.order>=0&&a.order<=1&&(h(),g+="orderByPrice="+a.order),e.httpGet(e.urlApiRestServer+(g.length?g:"")).then(function(a){var c=a.data,e=c.products,g=[];
b(e,function(a){g.push(new d(a))}),f.resolve({products:g,currency:c.currency,postage:c.postage,request:c.request})},function(a){f.reject(a)}),f.promise},e.prototype.getProduct=function(a){var b=this.$q.defer();return this.httpGet(this.urlApiRestServer+"/"+a).then(function(a){var c=a.data;b.resolve({product:new d(c.product),currency:c.currency,postage:c.postage})},function(a){b.reject(a)}),b.promise};var f=function(a){return new e(a)};return{create:f}}])}(upp),function(a){"use strict";a.factory("product",function(){function a(a){this.id=a.id,this.name=a.name,this.category=a.category,this.brand=a.brand,this.attributes=a.attributes,this.description=a.description,this.goToBasket=a.goToBasket,this.features=a.features,this.files=a.files,this.preview=a.preview,this.promotions=a.promotions,this.tags=a.tags,this.price=a.price,this.selectedAttribute=a.selectedAttribute,this.selectedStock=a.selectedStock,this.noStock=!0}return a.prototype.isProductOrderOk=function(){return this.selectedStock&&this.selectedAttribute&&this.maxStock>=this.selectedStock},a.prototype.hasAttributesAndStock=function(){return this.selectedStock&&"undefined"!=typeof this.selectedStock&&this.selectedAttribute&&"undefined"!=typeof this.selectedAttribute},a})}(upp),function(a){"use strict";a["PRODUCTS.CATALOG.TOCART.PRECONFIRM"]="To cart",a["PRODUCTS.CATALOG.TOCART.CONFIRM"]="Add",a["PRODUCTS.PRODUCT.TOCART.CONFIRM"]="Add to cart",a["PRODUCTS.CATEGORY"]="Category",a["PRODUCTS.PRICE"]="Price",a["PRODUCTS.TAGS"]="Tags",a["PRODUCTS.FEATURES"]="Features",a["PRODUCTS.BRAND"]="Brand",a["PRODUCTS.FILTERS.NAME.LABEL"]="Name",a["PRODUCTS.FILTERS.NAME.PLACEHOLDER"]="-- Filter by name --",a["PRODUCTS.FILTERS.CATEGORY.LABEL"]="Category",a["PRODUCTS.FILTERS.CATEGORY.DEFAULT"]="-- Filter by category --",a["PRODUCTS.FILTERS.SUBCATEGORY.LABEL"]="Subcategory",a["PRODUCTS.FILTERS.SUBCATEGORY.DEFAULT"]="-- Filter by subcategory --",a["PRODUCTS.FILTERS.PRICE.LABEL"]="Price",a["PRODUCTS.FILTERS.PRICE.DEFAULT"]="-- Sort by price --",a["PRODUCTS.FILTERS.PRICE.ASC"]="From low to high",a["PRODUCTS.FILTERS.PRICE.DESC"]="From high to low",a["PRODUCTS.PRODUCT.SIZE"]="Size",a["PRODUCTS.PRODUCT.COLOR"]="Color",a["PRODUCTS.PRODUCT.NOSTOCK"]="Out of stock!",a["PRODUCTS.PRODUCT.TOOMUCHAMOUNT"]="Too much!",a["PRODUCTS.PRODUCT.AMOUNT"]="Amount"}(translations.en),function(a){"use strict";a["PRODUCTS.CATALOG.TOCART.PRECONFIRM"]="Añadir",a["PRODUCTS.CATALOG.TOCART.CONFIRM"]="Añadir",a["PRODUCTS.PRODUCT.TOCART.CONFIRM"]="Añadir a cesta",a["PRODUCTS.CATEGORY"]="Categoría",a["PRODUCTS.PRICE"]="Precio",a["PRODUCTS.TAGS"]="Etiquetas",a["PRODUCTS.FEATURES"]="Cuidados",a["PRODUCTS.BRAND"]="Marca",a["PRODUCTS.FILTERS.NAME.LABEL"]="Nombre",a["PRODUCTS.FILTERS.NAME.PLACEHOLDER"]="-- Filtrado por nombre --",a["PRODUCTS.FILTERS.CATEGORY.LABEL"]="Categoría",a["PRODUCTS.FILTERS.CATEGORY.DEFAULT"]="-- Filtrado por Categoría --",a["PRODUCTS.FILTERS.SUBCATEGORY.LABEL"]="Subcategoría",a["PRODUCTS.FILTERS.SUBCATEGORY.DEFAULT"]="-- Filtrado por Subcategoría --",a["PRODUCTS.FILTERS.PRICE.LABEL"]="Precio",a["PRODUCTS.FILTERS.PRICE.DEFAULT"]="-- Ordenar por precio --",a["PRODUCTS.FILTERS.PRICE.ASC"]="De más barato a más caro",a["PRODUCTS.FILTERS.PRICE.DESC"]="De más caro a más barato",a["PRODUCTS.PRODUCT.SIZE"]="Tamaño",a["PRODUCTS.PRODUCT.COLOR"]="Color",a["PRODUCTS.PRODUCT.NOSTOCK"]="¡Fuera de stock!",a["PRODUCTS.PRODUCT.TOOMUCHAMOUNT"]="¡Demasiado!",a["PRODUCTS.PRODUCT.AMOUNT"]="Cantidad"}(translations.es),function(a){"use strict";a.service("productsCategoriesService",["appi",function(a){var b=$UPP.PROPS.URL_UPPLICATION_REST_SERVICE+"eshop/categories",c=a.http.get,d=function(){return c(b)},e=function(a){if(a)return c(b+"?id="+a);throw new Error("parentId not indicated")};return{listParents:d,listChildrenOfParent:e}}])}(upp);